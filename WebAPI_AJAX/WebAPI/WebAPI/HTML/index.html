<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <script src="../../Scripts/jquery-1.10.2.js"></script>
    <!--  <script src="../../Scripts/registration.js"></script>-->
    <link href="../../Content/bootstrap.min.css" rel="stylesheet" />
    <link rel="stylesheet" type="text/css" href="../../Content/reg_style.css">
    <link href="https://fonts.googleapis.com/css?family=Indie+Flower" rel="stylesheet">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.0.13/css/all.css">
    <script src="../../Scripts/jquery-1.10.2.min.js"></script>
    <script src="../../Scripts/bootstrap.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.3.1.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
    <title>CIGIN TAXI</title>


    <script type="text/javascript">
        $(document).ready(function () {

            $("#registracijaFrame").css('display', 'none');

            $("p").click(function () {
                alert($(this).text());
            });

            $("#load-products").click(function () {
                $.get("/api/registracija", function (data, status) {
                    let tableOfProducts = "<table border='1'>";
                    for (korisnik in data) {
                        tableOfProducts += `<tr><td>${data[korisnik].Kime}</td><td>${data[korisnik].lozinka}</td></tr>`;
                    }
                    tableOfProducts += "</table>";
                    $("#content").html(tableOfProducts);
                });
            });

            $("#prijava").click(function () {
                let ki = $('#korime').val();
                let p = $('#korPass').val();

                if (ki == "" || p == "") {
                    alert("Popunite sva polja");
                }
                else {
                    let korisnik = {
                        Kime: `${$('#korime').val()}`,
                        lozinka: `${$('#korPass').val()}`,
                    };

                    $.ajax({

                        type: 'POST',
                        url: '/api/Prijava',
                        data: JSON.stringify(korisnik),
                        contentType: 'application/json; charset=utf-8',
                        dataType: 'json',
                        success: function (data) {
                            if (data != "Uspesno") {
                                $("#greskaPrijava").html("<p>" + data + "</p>");
                            }
                            else {
                                localStorage.setItem("korisnik", korisnik.Kime);
                                $("#greskaPrijava").html("<p>" + " " + "</p>");
                                alert("Prijavljeno");
                                $(location).attr('href', 'Next.html');
                            }


                        }
                    })
                }
            });

            $("#prikazi").click(function () {

                $("#prijavaFrame").hide(1000);
                $("#registracijaFrame").show(1000);
            });

            $("#registracija").click(function () {

                let ki = $('#korimeReg').val();
                let p = $('#korPassReg').val();
                let i = $('#ime').val();
                let pr = $('#prezime').val();
                let j = $('#jmbg').val();
                let e = $('#emailAdr').val();
                let t = $('#brTelefona').val();

                if (ki == "" || p == "" || i == "" || pr == "" || j == "" || e == "" || t == "")
                {
                    alert("Popunite sva polja");
                }
                else
                    {

                        let korisnik = {
                            Kime: `${$('#korimeReg').val()}`,
                            lozinka: `${$('#korPassReg').val()}`,
                            ime: `${$('#ime').val()}`,
                            prezime: `${$('#prezime').val()}`,
                            pol: `${$('#pol').val()}`,
                            JMBG: `${$('#jmbg').val()}`,
                            email: `${$('#emailAdr').val()}`,
                            telefon: `${$('#brTelefona').val()}`,
                    };
                        $.ajax({
                            type: 'POST',
                            url: '/api/Korisnik',
                            data: JSON.stringify(korisnik),
                            contentType: 'application/json; charset=utf-8',
                            dataType: 'json',
                            success: function (data) {
                                if (!data) {
                                    $("#greska").css("color", "red");
                                    // $("#greska").text("Postoji korisnik sa tim username-om");
                                    $("#korimeReg").focus();
                                    alert("Korisnicko ime je zauzeto");
                                }
                                else {
                                    $("#greska").text("");
                                    $("#prikazi").show();
                                    $("#registracijaDeo").hide(1000);
                                }

                            }
                        })
                    }

            });
         




        });
    </script>


</head>
<body>
    <nav class="navbar navbar-default">
        <div class="container">
            <div class="navbar-header"></div>
            <div class="collapse navbar-collapse" id="myNavbar">
                <ul class="nav navbar-nav navbar-right"></ul>
            </div>
            <h3>CIGIN TAXI</h3>
        </div>
    </nav>

    <div id="prijavaFrame" style="width:800px; margin:0 auto;">
        <h2>PRIJAVA</h2>
        <table>
            <tr>
                <td>ime: </td>
                <td><input id="korime" type="text" name="Kime" /></td>
            </tr>
            <tr>
                <td>lozinka: </td>
                <td><input id="korPass" type="password" name="lozinka" /></td>
            </tr>
            <tr><td><br /> </td><td></td></tr>
            <tr>
                <td></td>
                <td>  <button id="prikazi" type="button">Napravi nalog</button>  <button id="prijava" type="button">Prijavi se</button></td>
            </tr>
        </table>
    </div>

    <div id="greskaPrijava"></div>
    <div id="registracijaFrame" style="width:800px; margin:0 auto;">
        <h2> Registracija </h2>
        <table>
            <tr>
                <td>Korisnicko ime: </td>
                <td>
                    <input id="korimeReg" type="text" name="Kime" />
                </td>

            </tr>
            <tr>
                <td>lozinka: </td>
                <td><input id="korPassReg" type="password" name="lozinka" /></td>
            </tr>
            <tr>
                <td>ime: </td>
                <td><input id="ime" type="text" name="ime" /></td>
            </tr>
            <tr>
                <td>prezime: </td>
                <td><input id="prezime" type="text" name="prezime" /></td>
            </tr>

            <tr>
                <td>JMBG: </td>
                <td><input id="jmbg" type="text" name="JMBG" /></td>
            </tr>
            <tr>
                <td>Pol: </td>
                <td>
                    <select name="Pol" id="pol">
                        <option>
                            Zenski
                        </option>
                        <option>
                            Muski
                        </option>
                    </select>
                </td>
            </tr>
            <tr>
                <td>Broj telefona: </td>
                <td><input id="brTelefona" type="text" name="telefon" /></td>
            </tr>
            <tr>
                <td>email adresa:</td>
                <td><input id="emailAdr" type="email" name="email" /></td>
            </tr>
            <tr><td><br /></td></tr>
            <tr>
                <td></td>
                <td align="right"> <button id="registracija" type="button">Registruj se</button></td>
            </tr>
        </table>
        <p id="greskaRegistracija"></p>
      </div>
</body>
</html>